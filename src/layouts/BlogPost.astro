---
import type { CollectionEntry } from 'astro:content';
import BaseHead from '../components/BaseHead.astro';
import Footer from '../components/Footer.astro';
import Header from '../components/Header.astro';
import { siteConfig } from '../data/siteConfig';

type Props = CollectionEntry<'blog'>['data'] & { slug: string; readingTime?: number };

const { title, description, pubDate, updatedDate, heroImage, tags = [], canonicalUrl, slug, readingTime } = Astro.props;

const canonical = canonicalUrl ?? `${siteConfig.siteUrl}/blog/${slug}`;
const formattedDate = pubDate.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
---

<html lang="en" class="scroll-smooth">
	<head>
		<BaseHead
			title={title}
			description={description}
			image={heroImage ? undefined : siteConfig.ogImage}
			canonicalUrl={canonical}
			type="article"
			pubDate={pubDate}
			updatedDate={updatedDate}
		/>
	</head>

	<body class="bg-white dark:bg-slate-950 text-slate-900 dark:text-slate-100 font-sans antialiased">
		<Header />
		<main class="max-w-3xl mx-auto px-4 sm:px-6 py-12">
			<article>
				<header class="mb-10">
					<div class="flex items-center gap-3 text-sm text-slate-500 dark:text-slate-400 mb-4">
						<time datetime={pubDate.toISOString()}>{formattedDate}</time>
						{readingTime && <span>&middot; {readingTime} min read</span>}
						{updatedDate && (
							<span class="italic">&middot; Updated {updatedDate.toLocaleDateString('en-US', { month: 'long', year: 'numeric' })}</span>
						)}
					</div>
					<h1 class="text-3xl sm:text-4xl font-bold leading-tight mb-4">{title}</h1>
					<p class="text-lg text-slate-600 dark:text-slate-400">{description}</p>
					{tags.length > 0 && (
						<div class="flex flex-wrap gap-2 mt-4">
							{tags.map((tag) => (
								<span class="text-xs px-2 py-1 bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-400 rounded">
									{tag}
								</span>
							))}
						</div>
					)}
				</header>

				<div class="prose prose-slate dark:prose-invert max-w-none
					prose-headings:font-semibold prose-headings:tracking-tight
					prose-a:text-blue-600 dark:prose-a:text-blue-400
					prose-code:font-mono prose-code:text-sm
					prose-pre:bg-slate-900 prose-pre:text-slate-100
					prose-blockquote:border-blue-500
					leading-relaxed">
					<slot />
				</div>

				<footer class="mt-12 pt-8 border-t border-slate-200 dark:border-slate-800">
					<div class="flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4">
						<div>
							<p class="font-semibold text-slate-900 dark:text-slate-100">{siteConfig.author}</p>
							<p class="text-sm text-slate-500 dark:text-slate-400">{siteConfig.authorTitle}</p>
						</div>
						<div class="flex gap-3">
							<a href={siteConfig.social.linkedin} target="_blank" rel="noopener noreferrer"
								class="text-sm text-blue-600 dark:text-blue-400 hover:underline no-underline">
								LinkedIn
							</a>
							<a href={siteConfig.social.github} target="_blank" rel="noopener noreferrer"
								class="text-sm text-blue-600 dark:text-blue-400 hover:underline no-underline">
								GitHub
							</a>
						</div>
					</div>
				</footer>
			</article>
		</main>
		<Footer />
	</body>
</html>
